for(var v="function"==typeof Object.defineProperties?Object.defineProperty:function(f,c,b){f!=Array.prototype&&f!=Object.prototype&&(f[c]=b.value)},z="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,A=["Array","prototype","fill"],B=0;B<A.length-1;B++){var C=A[B];C in z||(z[C]={});z=z[C]}
var D=A[A.length-1],H=z[D],N=H?H:function(f,c,b){var a=this.length||0;0>c&&(c=Math.max(0,a+c));if(null==b||b>a)b=a;b=Number(b);0>b&&(b=Math.max(0,a+b));for(c=Number(c||0);c<b;c++)this[c]=f;return this};N!=H&&null!=N&&v(z,D,{configurable:!0,writable:!0,value:N});
(function(f){function c(a){if(b[a])return b[a].b;var g=b[a]={o:a,g:!1,b:{}};f[a].call(g.b,g,g.b,c);g.g=!0;return g.b}var b={};c.m=f;c.i=b;c.c=function(a,b){c.f(a)||Object.defineProperty(a,"a",{configurable:!1,enumerable:!0,get:b})};c.j=function(a){var b=a&&a.h?function(){return a["default"]}:function(){return a};c.c(b,b);return b};c.f=function(a){return Object.prototype.hasOwnProperty.call(a,"a")};c.l="";return c(c.s=0)})([function(){function f(){var d=b.indexOf(a);if(0>d||d+1>=b.length){d=document.createElement("canvas");
d.width=window.innerWidth;d.height=window.innerHeight;d.style.width=document.getElementById("overview").width+"px";d.style.height=document.getElementById("overview").height+"px";var I=d.getContext("2d");I.globalAlpha=.1;d.style.display="block";b.push({canvas:d,a:I});var h=b[b.length-1];d.onmousedown=function(){a=h;c()}.bind(this,h);a=h;document.getElementById("layers").appendChild(d)}else a=b[d+1];c()}function c(){document.getElementById("layerInfo").innerText="Layer "+(b.indexOf(a)+1)+"/"+b.length}
var b=[];console.log(atob("RnJlZHJpayBBbmRlcnNzb24gMjAxNyA8ZnJlZHJpa2FuZGVyc3NvbkBtYWMuY29tPg=="));window.addLayer=f;var a=null;window.removeLayer=function(){var d=b.indexOf(a);0<=d&&(b.splice(d,1),window.clearLayer(),a.canvas.parentNode.removeChild(a.canvas),b.length?a=b[0]:f());c()};window.clearLayer=function(){a.a.clearRect(0,0,a.canvas.width,a.canvas.height);document.getElementById("overview").getContext("2d").clearRect(0,0,document.getElementById("overview").width,document.getElementById("overview").height);
document.getElementById("paintlayer").getContext("2d").fillRect(0,0,a.canvas.width,a.canvas.height)};window.exportPng=function(){var d="<iframe width='100%' height='100%' src='"+document.getElementById("paintlayer").toDataURL("image/png")+"'></iframe>",a=window.open();a.document.open();a.document.write(d);a.document.close()};var g="hardBrush";window.liveBrush=!1;window.setBrush=function(d,a){window.activateBrush(d,a)};window.brushes={softBrush:function(d,a,b,c){d.filter="blur(1.5px)";d.clearRect(0,
0,c.width,c.height);d.beginPath();d.arc(b,b,a,0,2*Math.PI);d.fill()},hardBrush:function(d,a,b,c){d.filter="none";d.clearRect(0,0,c.width,c.height);d.beginPath();d.arc(b,b,a,0,2*Math.PI);d.fill()},dotBrush:function(d,a,b,c){d.filter="none";d.clearRect(0,0,c.width,c.height);for(c=0;c<5*a;c++)d.beginPath(),d.arc(b+2*Math.random()*a-a,b+2*Math.random()*a-a,.5,0,2*Math.PI),d.fill()},calligraphyBrush:function(a,b,c,f){a.filter="none";a.clearRect(0,0,f.width,f.height);a.beginPath();a.lineWidth=b/2;window.liveBrush&&
(f=Math.random()%360-180,a.rotate(f));b/=2;a.strokeStyle=a.fillStyle;a.moveTo(c-b,c-b);a.lineTo(c+b,c+b);a.stroke()},imageBrush:function(a,b,c,f){a.clearRect(0,0,f.width,f.height);var d=new Image;d.onload=function(){a.drawImage(d,0,0,document.getElementById("brush").width,document.getElementById("brush").height)};d.src="http://webneel.com/daily/sites/default/files/images/daily/09-2013/17-most-amazing-photo-hight-sea-tide.jpg"}};window.main=function(){function d(){t&&t();if(0>J--){J=100;var a=document.getElementById("overview"),
c=a.getContext("2d");b.forEach(function(b){c.drawImage(b.canvas,0,0,a.width,a.height)})}var e=document.getElementById("paintlayer"),K=e.getContext("2d");K.clearRect(0,0,e.width,e.height);b.forEach(function(a){K.drawImage(a.canvas,0,0,e.width,e.height)});window.requestAnimationFrame(d)}function c(){for(var a=0,b,c=L||0,d=255/e.width,f=255/e.height,y=u.getImageData(0,0,e.width,e.height),h=0;h<e.height;h++){for(var l=b=0;l<e.width;l++){var k=4*(l+h*e.width);y.data[k++]=a;y.data[k++]=b+=d;y.data[k++]=
c;y.data[k++]=255}a+=f}u.putImageData(y,0,0)}function h(a,b){b||E?(E=w.fillStyle=b||E,F="source-over"):w.fillStyle="black";a||(a=document.getElementById("brushSize").value);window.brushes[g](w,a,64,x);document.getElementById("brushSizeText").innerText=a+" px"}var t=null,J=100;d();var E="black",F="source-over",n=!1,l=document.getElementById("paintlayer"),p=document.getElementById("overview"),x=document.getElementById("brush"),e=document.getElementById("colorPalette"),u=e.getContext("2d"),w=x.getContext("2d"),
M=window.innerHeight/window.innerWidth;p.style.width="200px";p.style.height=parseInt(200*M)+"px";p.width=200;p.height=parseInt(200*M);f();l.style.width=l.width=window.innerWidth;l.style.height=l.height=window.innerHeight;document.getElementById("brushSize").onmousemove=function(){h(document.getElementById("brushSize").value)};window.activateBrush=function(a,b){g=a;window.liveBrush=b;w.setTransform(1,0,0,1,0,0);h()};c();var q=!1;e.onmouseup=function(){q=!1};e.onmousemove=function(a){if(q){var b=e.offsetLeft,
c=e.offsetTop,d=u.getImageData(0,0,e.width,e.height);c=4*(a.clientX-b+(a.clientY-c)*e.width);a=d.data[c++];b=d.data[c++];d=d.data[c++];document.getElementById("rcslider").value=a;document.getElementById("gcslider").value=b;document.getElementById("bcslider").value=d;h(void 0,"rgb("+a+","+b+","+d+")")}};e.onmouseout=function(){q=!1};e.onmousedown=function(a){q=!0;var b=e.offsetLeft,c=e.offsetTop,d=u.getImageData(0,0,e.width,e.height);c=4*(a.clientX-b+(a.clientY-c)*e.width);a=d.data[c++];b=d.data[c++];
d=d.data[c++];document.getElementById("rcslider").value=a;document.getElementById("gcslider").value=b;document.getElementById("bcslider").value=d;h(void 0,"rgb("+a+","+b+","+d+")")};document.getElementById("rcslider").onmousemove=document.getElementById("gcslider").onmousemove=document.getElementById("bcslider").onmousemove=function(){h(void 0,"rgb("+document.getElementById("rcslider").value+","+document.getElementById("gcslider").value+","+document.getElementById("bcslider").value+")")};var L=0;
document.getElementById("gslider").onmousemove=function(){L=document.getElementById("gslider").value;c()};h(13);var G=a.a;G.globalCompositeOperation=F;G.globalAlpha=.1;l.onmousedown=function(b){a.a.globalCompositeOperation=F;if(!n){var c=l.offsetLeft+64,d=l.offsetTop+64;r=k=b;a.a.drawImage(x,b.clientX-c,b.clientY-d);t=n=function(){if(r&&k){var b=r.clientX,e=k.clientX,f=r.clientY,g=k.clientY;if(b!=e||f!=g){var n=l.offsetLeft+64,t=l.offsetTop+64,u=!1;if(Math.abs(b-e)<Math.abs(f-g)){var m=b;b=f;f=m;
m=e;e=g;g=m;u=!0}b>e&&(m=b,b=e,e=m,m=f,f=g,g=m);m=e-b;for(var w=2*Math.abs(g-f),p=0,q=f;b<=e;b++)!window.liveBrush||b%4||h(),u?a.a.drawImage(x,q-n,b-t):a.a.drawImage(x,b-n,q-t),p+=w,p>m&&(q+=g>f?1:-1,p-=2*m)}else b=a.a.globalAlpha,G.globalAlpha=.01,window.liveBrush&&h(),a.a.drawImage(x,k.clientX-c+5*Math.random()-2.5,k.clientY-d+5*Math.random()-2.5),a.a.globalAlpha=b}r=k}}};document.getElementById("palette").onmouseover=l.onmouseup=function(){n&&(t=null);k=r=n=null};var r=null,k=null;l.onmousemove=
function(a){n&&(r&&k||(k=r=a),k=a)}}}]);
